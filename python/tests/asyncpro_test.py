#!/usr/bin/python3
# py3k version
"""Unit tests for URL dispatcher"""
import unittest
import re

import atpic.asyncpro

def normalize_res(res):
    # remove the dependancy on date of the paths
    n=[]
    pat=re.compile(b"n\/[0-9]{4}\/[0-9]{2}\/[0-9]{2}\/[0-9]{2}\/[0-9]{2}\/")
    for line in res:
        normalline=pat.sub(b'normal/',line)
        n.append(normalline)
    return n

class asyncprotest(unittest.TestCase):
    """USER legacy urls"""
    def testProcess(self):
        print('testing asyncpro')
        # self.assertEqual(response,url[4])
        # self.assertEqual(signature,url[3])


        messages=[

            # T= transform
            # L=log
            # D=dummy
            
            ( b'D|123456|1|9999|home/madon/jpg|866475.jpg' , [b'A|1|9999|10902|exif|xml|n/2014/07/19/06/56/1_9999_exif.xml', b'U|1|9999|image/jpeg|3888|2592||Canon|Canon EOS 400D DIGITAL|22.0|0.0015625|100|16|0|0|2008:04:13 08:53:14||', b'A|1|9999|405683|r1024|jpg|n/2014/07/19/06/56/1_9999_r1024.jpg', b'A|1|9999|154660|r600|jpg|n/2014/07/19/06/56/1_9999_r600.jpg', b'A|1|9999|65090|r350|jpg|n/2014/07/19/06/56/1_9999_r350.jpg', b'A|1|9999|23968|r160|jpg|n/2014/07/19/06/56/1_9999_r160.jpg', b'A|1|9999|14252|r70|jpg|n/2014/07/19/06/56/1_9999_r70.jpg', b'D|123456|1|9999|home/madon/jpg|866475.jpg'] ),
( b'D|123456|2|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|DSCF1390_alt1526.9m.JPG' , [b'A|2|8888|18887|exif|xml|n/2014/07/19/06/56/2_8888_exif.xml', b'U|2|8888|image/jpeg|2848|2136||FUJIFILM|FinePix F30|5.6|0.001470588235|8|16|0|0|2008:01:01 13:16:54|47.06362405|8.68933233333333', b'A|2|8888|189862|r1024|jpg|n/2014/07/19/06/56/2_8888_r1024.jpg', b'A|2|8888|79221|r600|jpg|n/2014/07/19/06/56/2_8888_r600.jpg', b'A|2|8888|37724|r350|jpg|n/2014/07/19/06/56/2_8888_r350.jpg', b'A|2|8888|19138|r160|jpg|n/2014/07/19/06/56/2_8888_r160.jpg', b'A|2|8888|14383|r70|jpg|n/2014/07/19/06/56/2_8888_r70.jpg', b'D|123456|2|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|DSCF1390_alt1526.9m.JPG'] ),
( b'D|123456|3|7777|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_OLYMPUS_SP500UZ.ORF' , [b'A|3|7777|21397|exif|xml|n/2014/07/19/06/56/3_7777_exif.xml', b'U|3|7777|image/x-olympus-orf|2832|2117||OLYMPUS IMAGING CORP.|SP500UZ|2.8|0.2|6.3|16|1|0|2007:10:14 15:02:51||', b'A|3|7777|734205|0|jpg|n/2014/07/19/06/56/3_7777_0.jpg', b'A|3|7777|225817|r1024|jpg|n/2014/07/19/06/56/3_7777_r1024.jpg', b'A|3|7777|98021|r600|jpg|n/2014/07/19/06/56/3_7777_r600.jpg', b'A|3|7777|48465|r350|jpg|n/2014/07/19/06/56/3_7777_r350.jpg', b'A|3|7777|25223|r160|jpg|n/2014/07/19/06/56/3_7777_r160.jpg', b'A|3|7777|19132|r70|jpg|n/2014/07/19/06/56/3_7777_r70.jpg', b'D|123456|3|7777|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_OLYMPUS_SP500UZ.ORF'] ),
( b'D|123456|4|6666|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_CANON_5D_ARGB.CR2' , [b'A|4|6666|47927|exif|xml|n/2014/07/19/06/56/4_6666_exif.xml', b'U|4|6666|image/x-canon-cr2|4368|2912||Canon|Canon EOS 5D|10.0|0.005|180|16|0|1|2006:01:15 19:04:48||', b'A|4|6666|390316|0|jpg|n/2014/07/19/06/56/4_6666_0.jpg', b'A|4|6666|73609|r1024|jpg|n/2014/07/19/06/56/4_6666_r1024.jpg', b'A|4|6666|34874|r600|jpg|n/2014/07/19/06/56/4_6666_r600.jpg', b'A|4|6666|20944|r350|jpg|n/2014/07/19/06/56/4_6666_r350.jpg', b'A|4|6666|13844|r160|jpg|n/2014/07/19/06/56/4_6666_r160.jpg', b'A|4|6666|11680|r70|jpg|n/2014/07/19/06/56/4_6666_r70.jpg', b'D|123456|4|6666|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_CANON_5D_ARGB.CR2'] ),
( b'D|123456|5|5555|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_SONY_A100.ARW' , [b'A|5|5555|39066|exif|xml|n/2014/07/19/06/56/5_5555_exif.xml', b'U|5|5555|image/x-sony-arw|3872|2592||SONY|DSLR-A100|11.0|0.01|60|16|1|0|2007:04:08 17:41:18||', b'A|5|5555|770573|0|jpg|n/2014/07/19/06/56/5_5555_0.jpg', b'A|5|5555|196186|r1024|jpg|n/2014/07/19/06/57/5_5555_r1024.jpg', b'A|5|5555|116888|r600|jpg|n/2014/07/19/06/57/5_5555_r600.jpg', b'A|5|5555|83767|r350|jpg|n/2014/07/19/06/57/5_5555_r350.jpg', b'A|5|5555|65971|r160|jpg|n/2014/07/19/06/57/5_5555_r160.jpg', b'A|5|5555|60601|r70|jpg|n/2014/07/19/06/57/5_5555_r70.jpg', b'D|123456|5|5555|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_SONY_A100.ARW'] ),
( b'D|123456|6|4444|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_PENTAX_K10D_SRGB.PEF' , [b'A|6|4444|35519|exif|xml|n/2014/07/19/06/57/6_4444_exif.xml', b'U|6|4444|image/x-pentax-pef|3936|2624||PENTAX Corporation|PENTAX K10D|8.0|0.004|108|16|0|0|2006:12:27 10:59:50||', b'A|6|4444|1078105|0|jpg|n/2014/07/19/06/57/6_4444_0.jpg', b'A|6|4444|225479|r1024|jpg|n/2014/07/19/06/57/6_4444_r1024.jpg', b'A|6|4444|92230|r600|jpg|n/2014/07/19/06/57/6_4444_r600.jpg', b'A|6|4444|39764|r350|jpg|n/2014/07/19/06/57/6_4444_r350.jpg', b'A|6|4444|16813|r160|jpg|n/2014/07/19/06/57/6_4444_r160.jpg', b'A|6|4444|11385|r70|jpg|n/2014/07/19/06/57/6_4444_r70.jpg', b'D|123456|6|4444|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_PENTAX_K10D_SRGB.PEF'] ),
( b'D|123456|7|3333|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_CANON_300D.CRW' , [b'A|7|3333|24566|exif|xml|n/2014/07/19/06/57/7_3333_exif.xml', b'U|7|3333|image/x-canon-crw|3072|2048||||2.8||||||||', b'A|7|3333|960993|0|jpg|n/2014/07/19/06/57/7_3333_0.jpg', b'A|7|3333|268027|r1024|jpg|n/2014/07/19/06/57/7_3333_r1024.jpg', b'A|7|3333|113706|r600|jpg|n/2014/07/19/06/57/7_3333_r600.jpg', b'A|7|3333|48312|r350|jpg|n/2014/07/19/06/57/7_3333_r350.jpg', b'A|7|3333|13708|r160|jpg|n/2014/07/19/06/57/7_3333_r160.jpg', b'A|7|3333|4025|r70|jpg|n/2014/07/19/06/57/7_3333_r70.jpg', b'D|123456|7|3333|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_CANON_300D.CRW'] ),
( b'D|123456|8|2222|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_SIGMA_SD10.X3F' , [b'A|8|2222|10104|exif|xml|n/2014/07/19/06/57/8_2222_exif.xml', b'U|8|2222|image/x-sigma-x3f|2268|1512||SIGMA|SIGMA SD10|8.0||||||||', b'A|8|2222|515542|0|jpg|n/2014/07/19/06/57/8_2222_0.jpg', b'A|8|2222|241335|r1024|jpg|n/2014/07/19/06/57/8_2222_r1024.jpg', b'A|8|2222|95745|r600|jpg|n/2014/07/19/06/57/8_2222_r600.jpg', b'A|8|2222|37839|r350|jpg|n/2014/07/19/06/57/8_2222_r350.jpg', b'A|8|2222|9809|r160|jpg|n/2014/07/19/06/57/8_2222_r160.jpg', b'A|8|2222|2578|r70|jpg|n/2014/07/19/06/57/8_2222_r70.jpg', b'D|123456|8|2222|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_SIGMA_SD10.X3F'] ),
( b'D|123456|9|1111|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_FUJI_S5000.RAF' , [b'A|9|1111|17173|exif|xml|n/2014/07/19/06/57/9_1111_exif.xml', b'U|9|1111|image/x-fujifilm-raf|1280|960||FUJIFILM|FinePix S5000|2.8|0.003571428571|5.7|16|0|0|2008:06:22 03:48:05||', b'A|9|1111|662007|0|jpg|n/2014/07/19/06/57/9_1111_0.jpg', b'A|9|1111|152253|r600|jpg|n/2014/07/19/06/57/9_1111_r600.jpg', b'A|9|1111|62154|r350|jpg|n/2014/07/19/06/57/9_1111_r350.jpg', b'A|9|1111|21723|r160|jpg|n/2014/07/19/06/57/9_1111_r160.jpg', b'A|9|1111|12668|r70|jpg|n/2014/07/19/06/57/9_1111_r70.jpg', b'D|123456|9|1111|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_FUJI_S5000.RAF'] ),
( b'D|123456|10|9999|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_MINOLTA_A1.MRW' , [b'A|10|9999|22019|exif|xml|n/2014/07/19/06/57/10_9999_exif.xml', b'U|10|9999|image/x-minolta-mrw|2560|1920||Minolta Co., Ltd.|DiMAGE A1|3.5|0.125|7.21484375|16|1|0|2004:03:28 00:45:47||', b'A|10|9999|843138|0|jpg|n/2014/07/19/06/57/10_9999_0.jpg', b'A|10|9999|329762|r1024|jpg|n/2014/07/19/06/57/10_9999_r1024.jpg', b'A|10|9999|131271|r600|jpg|n/2014/07/19/06/57/10_9999_r600.jpg', b'A|10|9999|49254|r350|jpg|n/2014/07/19/06/57/10_9999_r350.jpg', b'A|10|9999|14260|r160|jpg|n/2014/07/19/06/57/10_9999_r160.jpg', b'A|10|9999|7455|r70|jpg|n/2014/07/19/06/57/10_9999_r70.jpg', b'D|123456|10|9999|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_MINOLTA_A1.MRW'] ),
( b'D|123456|11|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_NIKON_D70.NEF' , [b'A|11|8888|29658|exif|xml|n/2014/07/19/06/57/11_8888_exif.xml', b'U|11|8888|image/x-nikon-nef|3040|2014||NIKON CORPORATION|NIKON D70|7.1|0.005|50|16|0|0|2004:06:26 14:16:26||', b'A|11|8888|708214|0|jpg|n/2014/07/19/06/57/11_8888_0.jpg', b'A|11|8888|242516|r1024|jpg|n/2014/07/19/06/57/11_8888_r1024.jpg', b'A|11|8888|109696|r600|jpg|n/2014/07/19/06/57/11_8888_r600.jpg', b'A|11|8888|50566|r350|jpg|n/2014/07/19/06/57/11_8888_r350.jpg', b'A|11|8888|19460|r160|jpg|n/2014/07/19/06/57/11_8888_r160.jpg', b'A|11|8888|10847|r70|jpg|n/2014/07/19/06/57/11_8888_r70.jpg', b'D|123456|11|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|raw/RAW_NIKON_D70.NEF'] ),
( b'D|123456|12|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|videos/better_MVI_5848.AVI' , [b'A|12|8888|10649|exif|xml|n/2014/07/19/06/57/12_8888_exif.xml', b'U|12|8888|video/x-msvideo|640|480|19.933134|||||||||||', b'A|12|8888|228623|v0|png|n/2014/07/19/06/57/12_8888_v0.png', b'A|12|8888|325915|vf0|png|n/2014/07/19/06/57/12_8888_vf0.png', b'A|12|8888|98781|v350|png|n/2014/07/19/06/57/12_8888_v350.png', b'A|12|8888|299944|vf350|png|n/2014/07/19/06/57/12_8888_vf350.png', b'A|12|8888|29682|v160|png|n/2014/07/19/06/57/12_8888_v160.png', b'A|12|8888|70015|vf160|png|n/2014/07/19/06/57/12_8888_vf160.png', b'A|12|8888|7285|v70|png|n/2014/07/19/06/57/12_8888_v70.png', b'A|12|8888|14233|vf70|png|n/2014/07/19/06/57/12_8888_vf70.png', b'D|123456|12|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|videos/better_MVI_5848.AVI'] ),
( b'D|123456|13|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|videos/loic.MPG' , [b'A|13|8888|4193|exif|xml|n/2014/07/19/06/57/13_8888_exif.xml', b'U|13|8888|video/mpeg|720|576|5.9732596112311|||||||||||', b'A|13|8888|501416|v0|png|n/2014/07/19/06/57/13_8888_v0.png', b'A|13|8888|730862|vf0|png|n/2014/07/19/06/57/13_8888_vf0.png', b'A|13|8888|137348|v350|png|n/2014/07/19/06/57/13_8888_v350.png', b'A|13|8888|324715|vf350|png|n/2014/07/19/06/57/13_8888_vf350.png', b'A|13|8888|37801|v160|png|n/2014/07/19/06/57/13_8888_v160.png', b'A|13|8888|72988|vf160|png|n/2014/07/19/06/57/13_8888_vf160.png', b'A|13|8888|9014|v70|png|n/2014/07/19/06/57/13_8888_v70.png', b'A|13|8888|14800|vf70|png|n/2014/07/19/06/57/13_8888_vf70.png', b'D|123456|13|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|videos/loic.MPG'] ),
( b'D|123456|14|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample.3gp' , [b'A|14|8888|12557|exif|xml|n/2014/07/19/06/57/14_8888_exif.xml', b'U|14|8888|video/3gpp|176|144||||||||||||', b'A|14|8888|481|v0|png|n/2014/07/19/06/57/14_8888_v0.png', b'A|14|8888|980|vf0|png|n/2014/07/19/06/57/14_8888_vf0.png', b'A|14|8888|353|v70|png|n/2014/07/19/06/57/14_8888_v70.png', b'A|14|8888|904|vf70|png|n/2014/07/19/06/57/14_8888_vf70.png', b'D|123456|14|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample.3gp'] ),
( b'D|123456|15|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample_mpeg4.mp4' , [b'A|15|8888|12570|exif|xml|n/2014/07/19/06/57/15_8888_exif.xml', b'U|15|8888|video/mp4|190|240||||||||||||', b'A|15|8888|1066|v0|png|n/2014/07/19/06/57/15_8888_v0.png', b'A|15|8888|3809|vf0|png|n/2014/07/19/06/57/15_8888_vf0.png', b'A|15|8888|581|v160|png|n/2014/07/19/06/57/15_8888_v160.png', b'A|15|8888|5126|vf160|png|n/2014/07/19/06/57/15_8888_vf160.png', b'A|15|8888|424|v70|png|n/2014/07/19/06/57/15_8888_v70.png', b'A|15|8888|2679|vf70|png|n/2014/07/19/06/57/15_8888_vf70.png', b'D|123456|15|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample_mpeg4.mp4'] ),
( b'D|123456|16|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample_mpeg2.m2v' , [b'A|16|8888|2854|exif|xml|n/2014/07/19/06/57/16_8888_exif.xml', b'U|16|8888|video/mpeg|192|240|5.381392|||||||||||', b'A|16|8888|896|v0|png|n/2014/07/19/06/57/16_8888_v0.png', b'A|16|8888|1662|vf0|png|n/2014/07/19/06/57/16_8888_vf0.png', b'A|16|8888|605|v160|png|n/2014/07/19/06/57/16_8888_v160.png', b'A|16|8888|1800|vf160|png|n/2014/07/19/06/57/16_8888_vf160.png', b'A|16|8888|537|v70|png|n/2014/07/19/06/57/16_8888_v70.png', b'A|16|8888|692|vf70|png|n/2014/07/19/06/57/16_8888_vf70.png', b'D|123456|16|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample_mpeg2.m2v'] ),
( b'D|123456|17|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample_iPod.m4v' , [b'A|17|8888|12661|exif|xml|n/2014/07/19/06/57/17_8888_exif.xml', b'U|17|8888|video/x-m4v|320|240||||||||||||', b'A|17|8888|5577|v0|png|n/2014/07/19/06/57/17_8888_v0.png', b'A|17|8888|9680|vf0|png|n/2014/07/19/06/57/17_8888_vf0.png', b'A|17|8888|1518|v160|png|n/2014/07/19/06/57/17_8888_v160.png', b'A|17|8888|4815|vf160|png|n/2014/07/19/06/57/17_8888_vf160.png', b'A|17|8888|807|v70|png|n/2014/07/19/06/57/17_8888_v70.png', b'A|17|8888|1773|vf70|png|n/2014/07/19/06/57/17_8888_vf70.png', b'D|123456|17|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample_iPod.m4v'] ),
( b'D|123456|18|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample_sorenson.mov' , [b'A|18|8888|14497|exif|xml|n/2014/07/19/06/57/18_8888_exif.xml', b'U|18|8888|video/quicktime|190|240||||||||||||', b'A|18|8888|932|v0|png|n/2014/07/19/06/58/18_8888_v0.png', b'A|18|8888|1806|vf0|png|n/2014/07/19/06/58/18_8888_vf0.png', b'A|18|8888|482|v160|png|n/2014/07/19/06/58/18_8888_v160.png', b'A|18|8888|1311|vf160|png|n/2014/07/19/06/58/18_8888_vf160.png', b'A|18|8888|391|v70|png|n/2014/07/19/06/58/18_8888_v70.png', b'A|18|8888|1021|vf70|png|n/2014/07/19/06/58/18_8888_vf70.png', b'D|123456|18|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample_sorenson.mov'] ),
( b'D|123456|19|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/samplelog1.txt' , [b'A|19|8888|1583|exif|xml|n/2014/07/19/06/58/19_8888_exif.xml', b'U|19|8888|||||||||||||||', b'D|123456|19|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/samplelog1.txt'] ),
( b'D|123456|20|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample_iTunes.mov' , [b'A|20|8888|12649|exif|xml|n/2014/07/19/06/58/20_8888_exif.xml', b'U|20|8888|video/quicktime|640|480||||||||||||', b'A|20|8888|17417|v0|png|n/2014/07/19/06/58/20_8888_v0.png', b'A|20|8888|33134|vf0|png|n/2014/07/19/06/58/20_8888_vf0.png', b'A|20|8888|6701|v350|png|n/2014/07/19/06/58/20_8888_v350.png', b'A|20|8888|21984|vf350|png|n/2014/07/19/06/58/20_8888_vf350.png', b'A|20|8888|1812|v160|png|n/2014/07/19/06/58/20_8888_v160.png', b'A|20|8888|5656|vf160|png|n/2014/07/19/06/58/20_8888_vf160.png', b'A|20|8888|869|v70|png|n/2014/07/19/06/58/20_8888_v70.png', b'A|20|8888|2176|vf70|png|n/2014/07/19/06/58/20_8888_vf70.png', b'D|123456|20|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample_iTunes.mov'] ),
( b'D|123456|21|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample_3GPP2.3g2' , [b'A|21|8888|12597|exif|xml|n/2014/07/19/06/58/21_8888_exif.xml', b'U|21|8888|video/3gpp2|176|144||||||||||||', b'A|21|8888|481|v0|png|n/2014/07/19/06/58/21_8888_v0.png', b'A|21|8888|980|vf0|png|n/2014/07/19/06/58/21_8888_vf0.png', b'A|21|8888|353|v70|png|n/2014/07/19/06/58/21_8888_v70.png', b'A|21|8888|904|vf70|png|n/2014/07/19/06/58/21_8888_vf70.png', b'D|123456|21|8888|home/madon/public_html/perso/entreprise/sql_current/site/atpic/python/tests/fixture|video_apple/sample_3GPP2.3g2'] ),
            ]


        for (message,expected) in messages:
            print('-------------------')
            print('XXXX doing', message)
            output=atpic.asyncpro.process(message,None)
            print('YYYY (', message ,',', output,'),')

        
            normal_output=normalize_res(output)
            normal_expected=normalize_res(expected)
            # print('ZZZZ ',normal_output)
            for line in output:
                print(line)
            self.assertEqual(normal_output,normal_expected)
            




if __name__=="__main__":
    unittest.main()
